version 3 with bisect